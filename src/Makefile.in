SHELL = /bin/sh

srcdir = @srcdir@
VPATH = @srcdir@

JAVAC = @JAVAC@
JAVACFLAGS = @JAVACFLAGS@
JAR = @JAR@

SRCS = $(shell $(srcdir)/srclist $(srcdir))

OBJS = $(patsubst %.java,%.class,$(SRCS))

img_dir = org/doit/muffin/images
doc_dir = org/doit/muffin/doc

all:	classes jar

classes:
	CLASSPATH=$(srcdir):$(CLASSPATH) $(JAVAC) -d . $(JAVACFLAGS) $(SRCS)

jar:
	$(RM) muffin.jar
	rm -rf $(img_dir) $(doc_dir)
	mkdir -p $(img_dir) $(doc_dir)
	cp $(srcdir)/../images/*.jpg $(img_dir)
	cp $(srcdir)/../doc/filter/*.txt $(doc_dir)
	cp $(srcdir)/../COPYING $(doc_dir)/COPYING.txt
	$(JAR) cvf muffin.jar $(OBJS) $(img_dir)/*.jpg $(doc_dir)/*.txt

clean:
	$(RM) $(OBJS) muffin
	$(RM) -rf $(img_dir) $(doc_dir)

distclean: clean
